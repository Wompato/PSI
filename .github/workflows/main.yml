name: Deploy to Staging

on:
  push:
    branches:
      - staging

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Install sshpass
      run: sudo apt-get install sshpass

    - name: Sync files to staging server
      run: |
        sshpass -p "${{ secrets.SSH_PSWD }}" rsync -avz --delete \
        -e "ssh -o StrictHostKeyChecking=no -p 7822" \
        ./ ${{ secrets.SSH_USER }}@${{ secrets.VPS_IP }}:/home/psiedu/staging.psi.edu/wp-content/themes/generatepress_child/
